# Contributing Guidelines

There are some things that should be kept in mind when contributing to this project.

- Each commit is expected to pass CI on its own, (even if it's not automatically enforced by the CI pipeline).
- Bug fixes and feature additions should be accompanied by tests.
- Commit messages should at the very least give some explanation of what has changed, writing "Fix." does not count. Gold star to you if the message also includes a motivation. The ideal is to follow [Conventional Commits](https://www.conventionalcommits.org/).
- Each pull request should add their changes to the [CHANGELOG.md](CHANGELOG.md) and attempt to follow the conventions described in [Keep a Changelog](https://keepachangelog.com).
- Comments, if not a documentation comment, should follow [Conventional Comments](https://conventionalcomments.org/).

Structure requirements on commit messages, issues and pull requests are other than that pretty relaxed, (for now ðŸ¤ž).

### Recommended developer tools:

##### LSPs

- [`typos-lsp`](https://github.com/tekumara/typos-lsp)
- [`taplo`](https://github.com/tamasfe/taplo)
- [`rust-analyzer`](https://github.com/rust-lang/rust-analyzer)

### Using pre-commit hooks

Using a pre-commit hook to locally check simpler CI validation steps is encouraged to avoid squash commit requests by the maintainers, but also `git commit --amend && git push --force` abuse. This can be achieved by pasting the following into `.git/hooks/pre-commit`:

```sh
pip install pre-commit
pre-commit install
```

### Running tests

Pretty standard procedure apart from noting that some tests may be behind feature flags, so:

```sh
cargo test --all-features

# for book testing
mdbook test
```

### Generating and opening documentation

```sh
cargo doc --no-deps --all-features --open
```

Book documentation may be generated by installing [`mdbook`](https://rust-lang.github.io/mdBook/guide/installation.html) before running `mdbook serve --open`.

## Release (for maintainers)

1. Make sure CI is not failing.
2. Bump version in the workspace `Cargo.toml` file.
3. Move the unreleased section in the CHANGELOG.md into a release with the current date added.
4. Finally:

```sh
git commit -am "release: prepare X.X.X"
git tag "X.X.X"
git push && git push --tags
```
